{
  "name": "microsoft-defender-vulnerability-management",
  "label": "Microsoft Defender Vulnerability Management",
  "version": "1.0.0",
  "description": "Microsoft's Defender Vulnerability Management is a built-in module in Microsoft Defender for Endpoint that can discover vulnerabilities and misconfigurations in near real time, prioritize vulnerabilities based on the threat landscape and detections in your organization.",
  "publisher": "Fortinet",
  "cs_approved": true,
  "cs_compatible": true,
  "category": "Vulnerability and Risk Management",
  "icon_small_name": "small.png",
  "icon_large_name": "large.png",
  "help_online": "",
  "configuration": {
    "fields": [
      {
        "title": "Get Access Token",
        "required": true,
        "editable": true,
        "visible": true,
        "type": "select",
        "options": [
          "On behalf of User - Delegated Permission",
          "Without a User - Application Permission"
        ],
        "name": "auth_type",
        "value": "Without a User - Application Permission",
        "description": "Select the method using which you will get authentication tokens used to access the Microsoft's Defender Vulnerability Management APIs. You can choose between On behalf of User – Delegate Permission or Without a User - Application Permission.",
        "onchange": {
          "Without a User - Application Permission": [
            {
              "title": "Server URL",
              "name": "resource",
              "type": "text",
              "description": "The service-based URL to which you will connect and perform the automated operations.",
              "tooltip": "The service-based URL to which you will connect and perform the automated operations.",
              "placeholder": "https://api.securitycenter.microsoft.com",
              "required": true,
              "editable": true,
              "visible": true,
              "value": "https://api.securitycenter.microsoft.com"
            },
            {
              "title": "Directory (Tenant) ID",
              "name": "tenant_id",
              "type": "text",
              "description": "The ID of the tenant that you have been provided for your Azure Active Directory instance.",
              "tooltip": "The ID of the tenant that you have been provided for your Azure Active Directory instance.",
              "required": true,
              "editable": true,
              "visible": true
            },
            {
              "title": "Application (Client) ID",
              "name": "client_id",
              "type": "text",
              "description": "Unique ID of the Azure Active Directory application that is used to create an authentication token required to access the API.",
              "tooltip": "Unique ID of the Azure Active Directory application that is used to create an authentication token required to access the API.",
              "required": true,
              "editable": true,
              "visible": true
            },
            {
              "title": "Application (Client) Secret",
              "name": "client_secret",
              "type": "password",
              "description": "Unique Client Secret of the Azure Active Directory application that is used to create an authentication token required to access the API.",
              "tooltip": "Unique Client Secret of the Azure Active Directory application that is used to create an authentication token required to access the API.",
              "required": true,
              "editable": true,
              "visible": true
            }
          ],
          "On behalf of User - Delegated Permission": [
            {
              "title": "Server URL",
              "name": "resource",
              "type": "text",
              "description": "The service-based URL to which you will connect and perform the automated operations.",
              "tooltip": "The service-based URL to which you will connect and perform the automated operations.",
              "placeholder": "https://api.security.microsoft.com",
              "value": "https://api.security.microsoft.com",
              "required": true,
              "editable": true,
              "visible": true
            },
            {
              "title": "Directory (Tenant) ID",
              "name": "tenant_id",
              "type": "text",
              "description": "The ID of the tenant that you have been provided for your Azure Active Directory instance.",
              "tooltip": "The ID of the tenant that you have been provided for your Azure Active Directory instance.",
              "required": true,
              "editable": true,
              "visible": true
            },
            {
              "title": "Application (Client) ID",
              "name": "client_id",
              "type": "text",
              "description": "Unique ID of the Azure Active Directory application that is used to create an authentication token required to access the API.",
              "tooltip": "Unique ID of the Azure Active Directory application that is used to create an authentication token required to access the API.",
              "required": true,
              "editable": true,
              "visible": true
            },
            {
              "title": "Application (Client) Secret",
              "name": "client_secret",
              "type": "password",
              "description": "Unique Client Secret of the Azure Active Directory application that is used to create an authentication token required to access the API.",
              "tooltip": "Unique Client Secret of the Azure Active Directory application that is used to create an authentication token required to access the API.",
              "required": true,
              "editable": true,
              "visible": true
            },
            {
              "title": "Authorization Code",
              "name": "code",
              "type": "password",
              "tooltip": "The authorization code that you acquired in the authorization step.",
              "description": "(Only Applicable to On behalf of User – Delegate Permission) The authorization code that you acquired during the authorization step. For more information, see the Getting Access Tokens using the On behalf of the user – Delegate Permission method section. ",
              "required": true,
              "editable": true,
              "visible": true
            },
            {
              "title": "Redirect URI",
              "name": "redirect_url",
              "type": "text",
              "tooltip": "The redirect_uri of your app, where authentication responses can be sent and received by your app. It must exactly match one of the redirect_uri's you registered in the app registration portal.",
              "description": "(Only Applicable to On behalf of User – Delegate Permission) The redirect_uri of your app, where authentication responses can be sent and received by your app. The redirect URL that you specify here must exactly match one of the redirect_uri's you have registered in your app registration portal.",
              "placeholder": "E.g. https://localhost/myapp",
              "required": false,
              "editable": true,
              "visible": true
            }
          ]
        }
      },
      {
        "title": "Verify SSL",
        "required": false,
        "editable": true,
        "visible": true,
        "type": "checkbox",
        "name": "verify_ssl",
        "value": true,
        "description": "Specifies whether the SSL certificate for the server is to be verified or not. By default, this option is set as True."
      }
    ]
  },
  "operations": [
    {
      "title": "Get All Vulnerabilities",
      "description": "Retrieves a list of all the vulnerabilities affecting the organization from Microsoft Defender Vulnerability Management",
      "operation": "list_vulnerabilities",
      "category": "investigation",
      "annotation": "list_vulnerabilities",
      "parameters": [
        {
          "title": "ID",
          "description": "Specify the vulnerability ID whose details you want to retrieve from Microsoft Defender Vulnerability Management.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "id",
          "tooltip": "Specify the vulnerability ID whose details you want to retrieve from Microsoft Defender Vulnerability Management."
        },
        {
          "title": "Published On",
          "description": "Specify the Date when vulnerability was published on Microsoft Defender Vulnerability Management.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "datetime",
          "name": "publishedOn",
          "tooltip": "Specify the Date when vulnerability was published on Microsoft Defender Vulnerability Management."
        },
        {
          "title": "Severity",
          "description": "Specify the severity of vulnerability based on which you want to search vulnerability on Microsoft Defender Vulnerability Management.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "select",
          "options": [
            "Low",
            "Medium",
            "High",
            "Critical"
          ],
          "name": "severity",
          "tooltip": "Specify the severity of vulnerability based on which you want to search vulnerability on Microsoft Defender Vulnerability Management."
        },
        {
          "title": "Filter Query",
          "description": "Filter query based on which you want to retrieve vulnerabilities from Microsoft Defender Vulnerability Management. The OData's Filter query is supported on id, name, description, cvssV3, publishedOn, severity, and updatedOn properties.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "$filter",
          "placeholder": "id eq 'CVE-2023-24040'",
          "tooltip": "Filter query based on which you want to retrieve vulnerabilities from Microsoft Defender Vulnerability Management. The OData's Filter query is supported on id, name, description, cvssV3, publishedOn, severity, and updatedOn properties."
        },
        {
          "title": "Offset",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "$skip",
          "tooltip": "To skip the first n element based upon the value you specify in there",
          "description": "(Optional) Specify the count of the first few records to skip while retrieving response from Microsoft Defender Vulnerability Management."
        },
        {
          "title": "Number of Vulnerabilities to Fetch",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "integer",
          "name": "$top",
          "tooltip": "Maximum number of vulnerabilities that this operation should return, maximum is 10,000",
          "description": "(Optional) Specify the maximum number of vulnerabilities that this operation should return from Microsoft Defender Vulnerability Management. The maximum values it can return is 10,000."
        }
      ],
      "output_schema": {
        "@odata.context": "",
        "value": [
          {
            "id": "",
            "name": "",
            "description": "",
            "severity": "",
            "cvssV3": "",
            "exposedMachines": "",
            "publishedOn": "",
            "updatedOn": "",
            "publicExploit": "",
            "exploitVerified": "",
            "exploitInKit": "",
            "exploitTypes": [],
            "exploitUris": []
          }
        ]
      },
      "enabled": true
    },
    {
      "title": "Get Vulnerabilities By Machine And Software",
      "description": "Retrieves a list of all the vulnerabilities affecting the organization per machine and software.",
      "operation": "list_vulnerabilities_by_machine_and_software",
      "category": "investigation",
      "annotation": "list_vulnerabilities_by_machine_and_software",
      "parameters": [
        {
          "title": "ID",
          "description": "Specify the vulnerabilities ID whose details you want to retrieve from Microsoft Defender Vulnerability Management.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "id",
          "tooltip": "Specify the vulnerabilities ID whose details you want to retrieve from Microsoft Defender Vulnerability Management."
        },
        {
          "title": "Machine ID",
          "description": "Specify the Machine ID to get a list of all the vulnerabilities affecting the machine",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "machineId",
          "tooltip": "Specify the Machine ID to get a list of all the vulnerabilities affecting the machine."
        },
        {
          "title": "Severity",
          "description": "Specify the severity of vulnerability based on which you want to search vulnerability on Microsoft Defender Vulnerability Management.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "select",
          "options": [
            "Low",
            "Medium",
            "High",
            "Critical"
          ],
          "name": "severity",
          "tooltip": "Specify the severity of vulnerability based on which you want to search vulnerability on Microsoft Defender Vulnerability Management."
        },
        {
          "title": "Filter Query",
          "description": "Filter query based on which you want to retrieve vulnerabilities from Microsoft Defender Vulnerability Management. The OData's Filter query is supported on id, cveId, machineId, fixingKbId, productName, productVersion, severity, and productVendor properties.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "$filter",
          "placeholder": "",
          "tooltip": "Filter query based on which you want to retrieve vulnerabilities from Microsoft Defender Vulnerability Management. The OData's Filter query is supported on id, cveId, machineId, fixingKbId, productName, productVersion, severity, and productVendor properties."
        },
        {
          "title": "Offset",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "$skip",
          "tooltip": "To skip the first n element based upon the value you specify in there",
          "description": "(Optional) Specify the count of the first few records to skip while retrieving response from Microsoft Defender Vulnerability Management."
        },
        {
          "title": "Number of Vulnerabilities to Fetch",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "integer",
          "name": "$top",
          "tooltip": "Maximum number of vulnerabilities that this operation should return, maximum is 10,000",
          "description": "(Optional) Specify the maximum number of vulnerabilities that this operation should return from Microsoft Defender Vulnerability Management. The maximum values it can return is 10,000."
        }
      ],
      "output_schema": {
        "@odata.context": "",
        "value": [
          {
            "id": "",
            "cveId": "",
            "machineId": "",
            "fixingKbId": "",
            "productName": "",
            "productVendor": "",
            "productVersion": "",
            "severity": ""
          }
        ]
      },
      "enabled": true
    },
    {
      "title": "Get Vulnerability By ID",
      "description": "Retrieves vulnerability information by its ID",
      "operation": "get_vulnerability_by_id",
      "category": "investigation",
      "annotation": "get_vulnerability_by_id",
      "parameters": [
        {
          "title": "Vulnerability ID",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "id",
          "tooltip": "Unique identifier to represent the vulnerability",
          "description": "Specify the unique identifier that represents the vulnerability."
        }
      ],
      "output_schema": {
        "@odata.context": "",
        "id": "",
        "name": "",
        "description": "",
        "severity": "",
        "cvssV3": "",
        "exposedMachines": "",
        "publishedOn": "",
        "updatedOn": "",
        "publicExploit": "",
        "exploitVerified": "",
        "exploitInKit": "",
        "exploitTypes": [],
        "exploitUris": []
      },
      "enabled": true
    },
    {
      "title": "Get Devices By Vulnerability",
      "description": "Retrieve a list of devices that are associated with the vulnerability ID.",
      "operation": "list_devices_by_vulnerability",
      "category": "investigation",
      "annotation": "list_devices_by_vulnerability",
      "parameters": [
        {
          "title": "Vulnerability ID",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "id",
          "tooltip": "Unique identifier to represent the vulnerability",
          "description": "Specify the unique identifier that represents the vulnerability."
        }
      ],
      "output_schema": {
        "@odata.context": "",
        "value": [
          {
            "id": "",
            "computerDnsName": "",
            "osPlatform": "",
            "rbacGroupName": "",
            "rbacGroupId": ""
          }
        ]
      },
      "enabled": true
    }
  ]
}


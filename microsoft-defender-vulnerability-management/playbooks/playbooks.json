{
  "type": "workflow_collections",
  "data": [
    {
      "uuid": "2874730c-9896-419c-8dbc-df7b8125e25a",
      "@type": "WorkflowCollection",
      "name": "Sample - Microsoft Defender Vulnerability Management - 1.0.0",
      "description": "Microsoft's Defender Vulnerability Management is a built-in module in Microsoft Defender for Endpoint that can discover vulnerabilities and misconfigurations in near real time, prioritize vulnerabilities based on the threat landscape and detections in your organization.",
      "visible": true,
      "image": null,
      "recordTags": [
        "Microsoft",
        "microsoft-defender-vulnerability-management"
      ],
      "workflows": [
        {
          "@type": "Workflow",
          "uuid": "0315a24b-1914-4d2e-b7b7-bdf85703da1c",
          "collection": "/api/3/workflow_collections/2874730c-9896-419c-8dbc-df7b8125e25a",
          "triggerLimit": null,
          "description": "Retrieves a list of all the vulnerabilities affecting the organization from Microsoft Defender Vulnerability Management",
          "name": "Get All Vulnerabilities",
          "tag": "#Microsoft Defender Vulnerability Management",
          "recordTags": [
            "Microsoft",
            "microsoft-defender-vulnerability-management"
          ],
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "parameters": [],
          "synchronous": false,
          "triggerStep": "/api/3/workflow_steps/4b242993-e833-47ca-808f-a93549c465a7",
          "steps": [
            {
              "uuid": "4b242993-e833-47ca-808f-a93549c465a7",
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "status": null,
              "arguments": {
                "route": "2fb9e5cc-415d-4d6b-8ce6-14ac54dfa72f",
                "title": "Microsoft Defender Vulnerability Management: Get All Vulnerabilities",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "singleRecordExecution": false,
                "noRecordExecution": true,
                "executeButtonText": "Execute"
              },
              "left": "20",
              "top": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a"
            },
            {
              "uuid": "124f5ba9-4d6d-4eba-9929-9a910b2f2eec",
              "@type": "WorkflowStep",
              "name": "Get All Vulnerabilities",
              "description": null,
              "status": null,
              "arguments": {
                "name": "Microsoft Defender Vulnerability Management",
                "config": "''",
                "params": [],
                "version": "1.0.0",
                "connector": "microsoft-defender-vulnerability-management",
                "operation": "list_vulnerabilities",
                "operationTitle": "Get All Vulnerabilities",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "left": "188",
              "top": "120",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "uuid": "546de321-cb14-4d42-9f47-a0e4ad3c9f51",
              "label": null,
              "isExecuted": false,
              "name": "Start-> Get All Vulnerabilities",
              "sourceStep": "/api/3/workflow_steps/4b242993-e833-47ca-808f-a93549c465a7",
              "targetStep": "/api/3/workflow_steps/124f5ba9-4d6d-4eba-9929-9a910b2f2eec"
            }
          ]
        },
        {
          "@type": "Workflow",
          "uuid": "119111fc-107b-4201-b21c-4eca1cf8eaf7",
          "collection": "/api/3/workflow_collections/2874730c-9896-419c-8dbc-df7b8125e25a",
          "triggerLimit": null,
          "description": "Retrieves a list of all the vulnerabilities affecting the organization per machine and software.",
          "name": "Get Vulnerabilities By Machine And Software",
          "tag": "#Microsoft Defender Vulnerability Management",
          "recordTags": [
            "Microsoft",
            "microsoft-defender-vulnerability-management"
          ],
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "parameters": [],
          "synchronous": false,
          "triggerStep": "/api/3/workflow_steps/cac62650-9874-4b61-bfa1-295c9e624dec",
          "steps": [
            {
              "uuid": "cac62650-9874-4b61-bfa1-295c9e624dec",
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "status": null,
              "arguments": {
                "route": "dad33d5d-9640-41e2-acd3-105b5f77f2e3",
                "title": "Microsoft Defender Vulnerability Management: Get Vulnerabilities By Machine And Software",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "singleRecordExecution": false,
                "noRecordExecution": true,
                "executeButtonText": "Execute"
              },
              "left": "20",
              "top": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a"
            },
            {
              "uuid": "209f4dc4-f735-435c-8422-59e8f9c9ed41",
              "@type": "WorkflowStep",
              "name": "Get Vulnerabilities By Machine And Software",
              "description": null,
              "status": null,
              "arguments": {
                "name": "Microsoft Defender Vulnerability Management",
                "config": "''",
                "params": [],
                "version": "1.0.0",
                "connector": "microsoft-defender-vulnerability-management",
                "operation": "list_vulnerabilities_by_machine_and_software",
                "operationTitle": "Get Vulnerabilities By Machine And Software",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "left": "188",
              "top": "120",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "uuid": "44a24912-e65a-4139-ac71-0d73419eec67",
              "label": null,
              "isExecuted": false,
              "name": "Start-> Get Vulnerabilities By Machine And Software",
              "sourceStep": "/api/3/workflow_steps/cac62650-9874-4b61-bfa1-295c9e624dec",
              "targetStep": "/api/3/workflow_steps/209f4dc4-f735-435c-8422-59e8f9c9ed41"
            }
          ]
        },
        {
          "@type": "Workflow",
          "uuid": "19218294-bfbf-4eb3-94bd-918d5884704d",
          "collection": "/api/3/workflow_collections/2874730c-9896-419c-8dbc-df7b8125e25a",
          "triggerLimit": null,
          "description": "Retrieves vulnerability information by its ID",
          "name": "Get Vulnerability By ID",
          "tag": "#Microsoft Defender Vulnerability Management",
          "recordTags": [
            "Microsoft",
            "microsoft-defender-vulnerability-management"
          ],
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "parameters": [],
          "synchronous": false,
          "triggerStep": "/api/3/workflow_steps/2bd01b7f-f9d4-49de-9861-507d4361bec9",
          "steps": [
            {
              "uuid": "2bd01b7f-f9d4-49de-9861-507d4361bec9",
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "status": null,
              "arguments": {
                "route": "6200cada-dddb-41ca-be7d-95224a547ceb",
                "title": "Microsoft Defender Vulnerability Management: Get Vulnerability By ID",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "singleRecordExecution": false,
                "noRecordExecution": true,
                "executeButtonText": "Execute"
              },
              "left": "20",
              "top": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a"
            },
            {
              "uuid": "851cfaf9-ed0f-4d35-a952-685a4d8bc728",
              "@type": "WorkflowStep",
              "name": "Get Vulnerability By ID",
              "description": null,
              "status": null,
              "arguments": {
                "name": "Microsoft Defender Vulnerability Management",
                "config": "''",
                "params": [],
                "version": "1.0.0",
                "connector": "microsoft-defender-vulnerability-management",
                "operation": "get_vulnerability_by_id",
                "operationTitle": "Get Vulnerability By ID",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "left": "188",
              "top": "120",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "uuid": "a90b7476-b7d6-4b5b-af73-050789c7f6a5",
              "label": null,
              "isExecuted": false,
              "name": "Start-> Get Vulnerability By ID",
              "sourceStep": "/api/3/workflow_steps/2bd01b7f-f9d4-49de-9861-507d4361bec9",
              "targetStep": "/api/3/workflow_steps/851cfaf9-ed0f-4d35-a952-685a4d8bc728"
            }
          ]
        },
        {
          "@type": "Workflow",
          "uuid": "2732ddb4-5b1d-4a42-a62a-375500a94234",
          "collection": "/api/3/workflow_collections/2874730c-9896-419c-8dbc-df7b8125e25a",
          "triggerLimit": null,
          "description": "Retrieve a list of devices that are associated with the vulnerability ID.",
          "name": "Get Devices By Vulnerability",
          "tag": "#Microsoft Defender Vulnerability Management",
          "recordTags": [
            "Microsoft",
            "microsoft-defender-vulnerability-management"
          ],
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "parameters": [],
          "synchronous": false,
          "triggerStep": "/api/3/workflow_steps/0c0a8b46-e6bc-417c-9fee-c9d69b17e6d5",
          "steps": [
            {
              "uuid": "0c0a8b46-e6bc-417c-9fee-c9d69b17e6d5",
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "status": null,
              "arguments": {
                "route": "8e681bc6-05df-45b2-9b2b-f6d853927118",
                "title": "Microsoft Defender Vulnerability Management: Get Devices By Vulnerability",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "singleRecordExecution": false,
                "noRecordExecution": true,
                "executeButtonText": "Execute"
              },
              "left": "20",
              "top": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a"
            },
            {
              "uuid": "aa8b8b86-5129-4e3d-9282-c3e560470cd5",
              "@type": "WorkflowStep",
              "name": "Get Devices By Vulnerability",
              "description": null,
              "status": null,
              "arguments": {
                "name": "Microsoft Defender Vulnerability Management",
                "config": "''",
                "params": [],
                "version": "1.0.0",
                "connector": "microsoft-defender-vulnerability-management",
                "operation": "list_devices_by_vulnerability",
                "operationTitle": "Get Devices By Vulnerability",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "left": "188",
              "top": "120",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "uuid": "2a80e896-9116-4d9d-bf12-eccb1a5169a4",
              "label": null,
              "isExecuted": false,
              "name": "Start-> Get Devices By Vulnerability",
              "sourceStep": "/api/3/workflow_steps/0c0a8b46-e6bc-417c-9fee-c9d69b17e6d5",
              "targetStep": "/api/3/workflow_steps/aa8b8b86-5129-4e3d-9282-c3e560470cd5"
            }
          ]
        }
      ]
    }
  ]
}